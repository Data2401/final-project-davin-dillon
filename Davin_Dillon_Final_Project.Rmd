---
title: "Let's Go To The Movies"
author: 'Davin Dillon'
date: "2022-04-18"
output:
  slidy_presentation:
    font_adjustment: 1
    highlight: pygments
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
```



``` {r, include = F}

library(tidyverse) # multiple tidy packages
library(readr) # for reading files
library(ggplot2) # for plotting
library(plotly) # for interactive plotting
library(dplyr) # data manipulation
library(flextable)
library(formattable)

```



```{r, include = F}
budget <- read_csv('movies_budget.csv') # budget including new movies
oscars <- read_csv('the_oscar_award.csv') # oscar winners and losers
oscars <- oscars %>%    # rename year for join
  rename('year' = 'year_film')
meta <- read_csv('movies_metadata.csv') # majority of data used

inflation <- read_csv('inflation_data.csv') 
# inflation data for calculations

oscar_titles <- oscars %>% # count number of titles in oscar data
  distinct(film)

budget <- budget %>% 
  rename(vote_average = score) %>% # renaming vote data for joins etc
  rename(vote_count = votes)

oscar_wn_titles <- oscars %>% # count number of oscar winning movies
  filter(winner == T) %>% 
  distinct(film)


oscars <- oscars %>% 
  rename(Title = 'film')  # rename for joins

adj <- inflation %>% 
  mutate(multiplier = (22.82/amount)) 
# create multiplier column for easy calculations

budget <- budget %>% 
  rename(new_budget = Budget)  # rename for joins etc

```


<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<ul> <li>The largest part of my data comes from a data set I got from github.
[yash91sharma github](https://raw.githubusercontent.com/yash91sharma/IMDB-Movie-Dataset-Analysis/master/movie_metadata.csv) created the data for a project similar to mine in which they asked which countries made the most movies.This data set contains `r comma(nrow(meta), digits = 0)` rows of data and seems to have been made around 2017.</li>
 <li>I used [alexsychu kaggle](https://www.kaggle.com/code/alexsychu/movie-industry-eda-alex-chu-5-april-2022/data) to gather some more data up to 2020. This second dat set had an additional 7668 rows of data. This user was trying to answer the question of how to predict if a movie will do well.</li>
<li> Lastly for movie data, I used data from [unanimad kaggle](https://www.kaggle.com/datasets/unanimad/the-oscar-award) . This data set had 10395 rows of data and this kaggle user asked various questions about who won Oscars.</li> 
<li> My last and only 'non-movie' data set comes from [officialdata.org](https://www.officialdata.org/us/inflation/1800?amount=1#:~:text=Value%20of%20%241%20from%201800%20to%202022&text=The%20dollar%20had%20an%20average,Labor%20Statistics%20consumer%20price%20index.) , where I obtained 223 rows of inflation data which allowed me to calculate budgets and gross revenue with inflation as a factor.</li></ul> </span>


```{r, include = F}
options(scipen = 100) # avoid scientific notation 

full_budget <- full_join(meta, budget, on = 'Title') 
# full join of metadata and budget data to get new and old movies etc

full_bud <- full_budget %>% 
  mutate(budget = pmax(new_budget, meta_budget, na.rm = T)) %>% 
  select(Title,genres, budget,new_budget, meta_budget, popularity,year,
         release_date, revenue, runtime, vote_average,
         vote_count,gross)
# set budget to max of two different budgets.
# picking max is arbitrary, but needed in most cases


full_bud <- full_bud[-c(1,2,3),] %>%
   arrange(desc(as.numeric(budget)))
# remove first three unnecessary rows


# format(date, format="%Y")

```



```{r, include = F}

full_bud <- full_bud %>% 
  mutate(year = replace(year, year == 1900, 2022))


adj_bud <- full_join(full_bud, adj,
                             on = c('Title', 'year')) %>% 
  mutate(with_inflation = (as.numeric(budget) * (multiplier))) %>% 
  mutate(gross_inflation = (as.numeric(full_bud$gross)
                            * (multiplier))) %>% 
  select(Title,genres,vote_average, vote_count, budget,
         with_inflation, gross_inflation, year, gross,
         release_date) %>% 
  arrange(desc(with_inflation))  
  

```


```{r, include = F}


osc_bud <-  full_join(adj_bud, oscars, on  = c('Title'))


total_noms <- osc_bud %>% 
  filter(!is.na(winner))

total_wins <- osc_bud %>% 
  filter(winner == T)

bst_act <- osc_bud %>% 
  group_by(Title) %>% 
  filter(str_detect(category, 'ACT')) %>% 
  select(Title, genres, budget, category, winner)
bst_act_wn <- bst_act %>% 
  filter(!is.na(winner)) %>% 
  filter(winner == T) %>% 
  distinct(Title, .keep_all = T)

star_wars <- osc_bud %>% 
  group_by(Title) %>% 
  filter(str_detect(Title, 'Star Wars'))


bst_pic <-  osc_bud %>% 
  group_by(Title) %>% 
  filter((str_detect(category, 'PIC') | 
            str_detect(category, 'OUT'))) %>% 
  select(Title, genres, vote_count, vote_average, category, winner)


bst_pic_won <- bst_pic %>% 
  filter(winner == T)
```



```{r, include = F}

noms <- osc_bud %>% 
  distinct(Title)

```



```{r, include = F}

osc_pop <-  osc_bud %>% 
  mutate(vote_count = replace(vote_count, vote_count < 10000, NA)) %>%           filter(vote_count != 0) %>% 
  filter(!is.na(vote_count))
# filtered out movies that had less than 10000 votes  
# for popular  movie set 

total_votes <- sum(full_bud$vote_count, na.rm = T)
```


---

<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<h2> Some Dataset Numbers </h2> </span>


```{r, include = T}
# glimpse(oscar_titles)
# glimpse(oscar_wn_titles)
# glimpse(bst_act %>% distinct(Title))
# glimpse(bst_pic)
# glimpse(bst_pic_won)
# glimpse(noms) 

```


<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
The data I was able to collect contains `r comma(nrow(oscar_titles), digits = 0)` movies nominated for an Academy Award since its inception in 1929. Of these `r comma(nrow(oscar_titles),digits = 0)` movies. `r comma(nrow(oscar_wn_titles), digits = 0)` won at least one award. There have been `r comma(nrow(total_noms), digits = 0)` total Oscar nominations, and `r comma(nrow(total_wins), digits = 0)` total Oscar wins in the dataset. `r comma(nrow(bst_pic), digits = 0)` movies have been nominated for Best Picture in its many forms. Out of these, 
`r comma(nrow(bst_pic_won), digits = 0)` won.`r comma(nrow(bst_act %>% distinct(Title)), digits = 0)` movies have had an actor or actress nominated in either a leading or supporting role.`r comma(nrow(bst_act_wn), digits = 0)` movies had at least one winner in an acting category. </span>

---

<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<h2> Popular Movies </h2> </span>

```{r, include = T}
bst_pic_pop_wn <- osc_pop %>% 
  group_by(Title) %>% 
  filter((str_detect(category, 'PIC') |
            str_detect(category, 'OUT')) & winner == TRUE) %>% 
  select(Title,genres, vote_count, category, winner)

total_popular <- osc_pop %>% 
  distinct(Title)

bst_pic_pop <- osc_pop %>% 
  group_by(Title) %>% 
  filter((str_detect(category, 'PIC') | str_detect(category, 'OUT'))) %>% 
  select(Title, genres, vote_count, category, winner)

```


<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
There are a total of `r comma(total_votes, digits = 0)` votes in the dataset.`r comma(nrow(total_popular), digits = 0)` movies have received at least 10,000 votes on imdb. Of these movies, `r comma(nrow(bst_pic_pop), digits = 0)` were nominated for Best Picture. `r comma(nrow(bst_pic_pop_wn), digits = 0)` won Best Picture. Doing the math, this means that `r comma((nrow(bst_pic_won) - nrow(bst_pic_pop_wn)))` Best Picture winners have less than 10,000 votes on imdb according to this data.</span>
            



---

<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<h2> Plotting Profit</h2></span>




```{r, include = T}


osc_bud <- osc_bud[!is.na(osc_bud$budget), ]

p <- osc_bud %>% select(Title, genres, gross, budget, winner) %>% 
  ggplot(aes(x = as.numeric(budget), y = gross, color = winner, label = Title, alpha = 0.1)) +
  geom_abline(intercept = 0, slope = 1) +
  geom_point() 

ggplotly(p)
```

---

<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<h2>With Inflation</h2></span>


```{r}
p2 <- osc_bud %>% select(Title, genres, with_inflation,
                         gross_inflation, winner) %>% 
  ggplot(aes(x = as.numeric(with_inflation), y = gross_inflation, color = winner, label = Title, alpha = 0.1)) +
  geom_abline(intercept = 0, slope = 1) +
  geom_point() 

ggplotly(p2)
```

---


<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<h2>Highest Percent Profit</h2></span>


```{r, include = T}
high_prof <- osc_bud %>% 
  filter(budget != 0) %>% 
  mutate(pct_prof = 100 * (as.numeric(gross)/as.numeric(budget))) %>% 
  select(Title, budget, gross, pct_prof) %>% 
  arrange(desc(pct_prof))

flextable(head(high_prof, 50))



```

---

<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<h2> Lowest Percent Profit </h2></span>


```{r}

low_prof <- high_prof %>% 
  na.omit(budget) %>% 
  arrange(pct_prof)

flextable(head(low_prof, 50))


```

---


<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<h2>Who spends more money?</h2></span>



```{r , warning = FALSE}
win_prof <- osc_bud %>% 
  filter(winner == T) %>% 
  filter(!is.na(budget)) %>% 
  filter(!is.na(gross)) %>% 
  mutate(winner_profit = 100*sum(as.numeric(gross))/sum(as.numeric(budget))) 

lsr_prof <- osc_bud %>% 
  filter(winner == F) %>% 
  filter(!is.na(budget)) %>% 
  filter(!is.na(gross)) %>% 
  mutate(loser_profit = 100*sum(as.numeric(gross))/sum(as.numeric(budget))) 

no_nom_prof <- osc_bud %>% 
  filter(is.na(winner)) %>% 
  filter(!is.na(budget)) %>% 
  filter(!is.na(gross)) %>% 
  mutate(nonnom_profit = 100*sum(as.numeric(gross))/sum(as.numeric(budget))) 
osc_bud <- osc_bud %>% 
  mutate(budget = as.numeric(budget)) 

money_plot <- osc_bud %>% select(Title, genres, gross, budget,with_inflation,  winner) %>% 
  ggplot() +
  geom_density(aes((budget), fill = winner, alpha = 0.4))   + xlim(0, 50000000)


ggplotly(money_plot)


money_plot2 <- osc_bud %>% select(Title, genres, gross, with_inflation, budget, winner) %>% 
  ggplot() +
  geom_density(aes((with_inflation), fill = winner, alpha = 0.4))   + xlim(0, 500000000)


ggplotly(money_plot2)


```

<span style = "color:navy;, font-family:Arial, Helvetica, sans-serif;">
<ul><li>The average Oscar winner percent profit is `r comma(win_prof$winner_profit[1], digits = 2)`. </li>
<li>The average Oscar loser percent profit is `r comma(lsr_prof$loser_profit[1], digits = 2)`</li>
<li>The average non-nominated percent profit is `r comma(no_nom_prof$nonnom_profit[1], digits = 2)`.</li></ul></span>


<span style = "color: navy;, font-family:Arial, Helvetica, sans-serif;">
Who makes more money? </span>

